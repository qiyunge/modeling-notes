# Net Flow：从问题到算法的完整结构阐述
（Problem → Model → Structural Paradigm → Algorithm）

---

## 0. 总览

最大流（Net Flow）是算法理论中一个高度标准化的范例，
其价值不在于“某个具体算法”，
而在于清晰展示了：

> **问题 → 数学模型 → 结构范式 → 算法流程 → 反向结构证明**

这一整条逻辑链。

---

## 1️⃣ 问题层（Problem Layer）

### 问题描述（自然语言）

在一个具有容量限制的网络系统中，
从源点 s 向汇点 t 运输资源，
在不违反任何限制的前提下，
最多能运输多少？

### 关键特征
- 不涉及图论术语
- 不涉及算法
- 只表达“目标 + 现实限制”

---

## 2️⃣ 数学模型层（Mathematical Model Layer）

> 本层只包含 **决策变量、约束、目标函数**  
> 不包含任何“算法分析中派生的结构对象”。

### 2.1 模型对象
- 有向图 G = (V, E)
- 容量函数 c(e) ≥ 0

### 2.2 决策变量
- 流量函数 f(e)，定义在每条边上

### 2.3 约束条件
1. 容量约束  
   0 ≤ f(e) ≤ c(e)

2. 流守恒  
   对所有 v ≠ s,t：  
   sum_in(v) = sum_out(v)

### 2.4 目标函数
- 最大化流值 v(f)（从 s 流出的总流量）

### 重要说明
- cut **不属于模型层**
- 在不知道 cut 的情况下，模型依然完整可写

---

## 3️⃣ 结构范式层（Structural Paradigm Layer）

> 本层通过**分析模型**而产生，
> 用于刻画：
> - 可行改进空间
> - 结构性上界
> - 最优性的必然性

### 3.1 残量图（Residual Graph）
**作用：刻画当前解附近“还能怎么改”**

- forward residual：c(e) − f(e)
- backward residual：f(e)

说明：
- backward 边不代表原图允许反向送流
- 语义是“撤销已发送的流”

---

### 3.2 增广路（Augmenting Path）
**作用：刻画可行改进方向**

- 在残量图中存在 s → t 路径
⇒ 存在合法改进

结构意义：
> 只要有增广路，就还没有达到极限。

---

### 3.3 割（Cut）
**作用：刻画结构性上界 / 对偶对象**

- 将 V 划分为 (A,B)，s∈A, t∈B
- 割容量：
  c(A,B) = sum_{u∈A,v∈B} c(u,v)

关键结构事实：
> 对任意流 f、任意 cut (A,B)：  
> v(f) ≤ c(A,B)

说明：
- cut 不是模型变量
- cut 是模型分析后的派生结构
- 属于结构范式层

---

### 3.4 最大流 = 最小割（结构闭环）

当残量图中不存在 s → t 路径时：
- A* = 从 s 可达的节点集合
- (A*,B*) 构成一个 cut
- v(f) = c(A*,B*)

意义：
- 当前流达到结构上界
- 最优性成为结构事实，而非算法经验

---

## 4️⃣ 算法层（Algorithm Layer）

> 本层把“结构允许的操作”转化为**可执行流程**。

---

### 4.1 Ford–Fulkerson（增广路算法）

#### 算法流程
1. 初始化 f = 0
2. while 残量图中存在 s → t 增广路 P：
   - Δ = bottleneck(P)
   - 沿 P 执行 augment
3. 返回 f

#### 正确性逻辑
- 终止性：整数容量下有限步停止
- 最优性：停机 ⇒ 无增广路 ⇒ 存在 tight cut ⇒ 最大流

---

### 4.2 改进算法（算法范式的变化）

目的：**控制最坏复杂度，而非改变问题结构**

- Edmonds–Karp：最短增广路（BFS）
- Dinic：分层图 + blocking flow
- Scaling：阶段性忽略小改进
- Strongly polynomial：复杂度只依赖 |V|,|E|

说明：
- 结构范式不变
- 算法范式不同（选路策略不同）

---

### 4.3 Preflow–Push（打 * 的分支）

特征：
- 不显式寻找 s–t 增广路
- 使用局部 push / relabel
- 更偏工程效率

定位：
- 非结构主线
- 属于另一种算法范式
- 仍受同一结构范式（残量 / cut）支配

---

## 5️⃣ 算法分析的反向作用

### 核心现象
> 为了证明算法“会停、是对的、跑得快”，
> 不得不引入 cut、tightness、上界等结构对象。

结果：
- 算法分析反过来**完成了问题的结构理解**
- 最大流–最小割是算法走到尽头自然显露的结构事实

---

## 6️⃣ 层级关系总结（极重要）

| 层级 | 角色 |
|---|---|
| 问题层 | 现实语义 |
| 数学模型层 | 变量 + 约束 + 目标 |
| 结构范式层 | 可行空间、上界、极限 |
| 算法层 | 具体计算流程 |

关键判断：
- cut ∈ 结构范式层
- residual / augmenting / cut 同层
- 算法范式服从结构范式

---

## 7️⃣ 一句话总总结（可引用）

> **最大流问题展示了算法理论的标准路径：  
> 从现实问题出发，经由严谨的数学模型，  
> 在分析中提炼出结构范式，  
> 最终将结构范式转化为多种算法流程；  
> 算法分析本身又反过来完成了对问题结构的理解。**

